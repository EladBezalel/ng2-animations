{"version":3,"file":"animation_parser.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/animation/animation_parser.ts"],"names":[],"mappings":"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","sourcesContent":["import {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {Math} from '../facade/math';\nimport {\n  IS_DART,\n  RegExpWrapper,\n  isArray,\n  isPresent,\n  isBlank,\n  isNumber,\n  isString,\n  isStringMap,\n  NumberWrapper\n} from '../facade/lang';\n\nimport {\n  CompileAnimationEntryMetadata,\n  CompileAnimationStateMetadata,\n  CompileAnimationStateDeclarationMetadata,\n  CompileAnimationStateTransitionMetadata,\n  CompileAnimationMetadata,\n  CompileAnimationWithStepsMetadata,\n  CompileAnimationStyleMetadata,\n  CompileAnimationAnimateMetadata,\n  CompileAnimationGroupMetadata,\n  CompileAnimationSequenceMetadata\n} from '../compile_metadata';\n\nimport {AUTO_STYLE, FINAL_STATE_ALIAS} from '@angular/core';\n\nimport {\n  AnimationAst,\n  AnimationEntryAst,\n  AnimationStateAst,\n  AnimationStateTransitionAst,\n  AnimationStateDeclarationAst,\n  AnimationKeyframeAst,\n  AnimationStylesAst,\n  AnimationWithStepsAst,\n  AnimationSequenceAst,\n  AnimationGroupAst,\n  AnimationStepAst\n} from './animation_ast';\n\nimport {StylesCollection} from './styles_collection';\nimport {ParseError} from '../parse_util';\n\nconst _BASE_TEN = 10;\nconst _INITIAL_KEYFRAME = 0;\nconst _TERMINAL_KEYFRAME = 1;\nconst _ONE_SECOND = 1000;\n\nexport class AnimationParseError extends ParseError {\n  constructor(message) { super(null, message); }\n  toString(): string { return `${this.msg}`; }\n}\n\nexport class ParsedAnimationResult {\n  constructor(public ast: AnimationEntryAst, public errors: AnimationParseError[]) {}\n}\n\nexport function parseAnimationEntry(entry: CompileAnimationEntryMetadata): ParsedAnimationResult {\n  var errors: AnimationParseError[] = [];\n  var stateStyles: {[key: string]: AnimationStylesAst} = {};\n  var definitions: AnimationStateAst[] = [];\n  var transitions: CompileAnimationStateTransitionMetadata[] = [];\n  entry.definitions.forEach(def => {\n    if (def instanceof CompileAnimationStateDeclarationMetadata) {\n      var stateAst = _parseAnimationStateDeclaration(def, errors);\n      definitions.push(stateAst);\n      stateStyles[stateAst.stateName] = stateAst.styles;\n    } else {\n      transitions.push(<CompileAnimationStateTransitionMetadata>def);\n    }\n  });\n\n  transitions.forEach(transDef => {\n    var transAst = _parseAnimationStateTransition(transDef, stateStyles, errors);\n    definitions.push(transAst);\n  });\n\n  var ast = new AnimationEntryAst(entry.name, definitions);\n  return new ParsedAnimationResult(ast, errors);\n}\n\nfunction _parseAnimationStateDeclaration(stateMetadata: CompileAnimationStateDeclarationMetadata, errors: AnimationParseError[]): AnimationStateDeclarationAst {\n  var styleValues: {[key: string]: string|number}[] = [];\n  stateMetadata.styles.styles.forEach(stylesEntry => {\n    // TODO (matsko): change this when we get CSS class integration support\n    if (isStringMap(stylesEntry)) {\n      styleValues.push(<{[key: string]: string|number}>stylesEntry);\n    } else {\n      errors.push(new AnimationParseError(`State based animations cannot contain references to other states`));\n    }\n  });\n  var defStyles = new AnimationStylesAst(styleValues);\n  return new AnimationStateDeclarationAst(stateMetadata.stateName, defStyles);\n}\n\nfunction _parseAnimationStateTransition(transitionStateMetadata: CompileAnimationStateTransitionMetadata,\n                                        stateStyles: {[key: string]: AnimationStylesAst},\n                                        errors: AnimationParseError[]): AnimationStateAst {\n  var styles = new StylesCollection();\n  var transitionExpr = _parseAnimationTransitionExpr(transitionStateMetadata.stateChangeExpr, errors);\n  var sequence = _fillStartAndEndStateSteps(transitionStateMetadata.animation,\n                                            transitionExpr.fromState,\n                                            transitionExpr.toState,\n                                            stateStyles,\n                                            errors);\n\n  var animation = _normalizeStyleSteps(sequence, stateStyles, errors);\n  var animationAst = _parseAnimationDefinitionAnimation(animation, 0, styles, stateStyles, errors);\n  if (errors.length == 0) {\n    _fillAnimationAstStartingKeyframes(animationAst, styles, errors);\n  }\n\n  // this happens when only styles were animated within the sequence\n  if (animationAst.playTime === 0) {\n    //errors.push(new AnimationParseError('There are no animate steps set for the animation sequence'));\n  }\n  return new AnimationStateTransitionAst(transitionExpr.fromState, transitionExpr.toState, animationAst);\n}\n\nclass _ParsedTransitionExprResult {\n  constructor(public fromState: string, public toState: string) {}\n}\n\nfunction _parseAnimationTransitionExpr(eventStr: string, errors: AnimationParseError[]): _ParsedTransitionExprResult {\n  var stateTokens = eventStr.split(/\\s*[=-]>\\s*/g);\n  if (!isPresent(stateTokens) || stateTokens.length < 2) {\n    errors.push(new AnimationParseError(`the provided ${eventStr} is not of a supported format`));\n  }\n  return new _ParsedTransitionExprResult(stateTokens[0], stateTokens[1]);\n}\n\nfunction _fetchSylesFromState(stateName: string,\n                              stateStyles: {[key: string]: AnimationStylesAst}): CompileAnimationStyleMetadata {\n  var entry = stateStyles[stateName];\n  if (isPresent(entry)) {\n    var styles = <{[key: string]: string | number}[]>entry.styles;\n    return new CompileAnimationStyleMetadata(0, styles);\n  }\n  return null;\n}\n\nfunction _computeLhsSetDifference(valuesA: string[], valuesB: string[]): Array<string[]> {\n  var lhs = [];\n  var rhs = [];\n  var allValues = {};\n  valuesA.forEach(value => {\n    allValues[value] = 1;\n  });\n\n  valuesB.forEach(value => {\n    var val: number = allValues[value];\n    val = isPresent(val) ? val : 0;\n    allValues[value] = val - 1;\n  });\n\n  StringMapWrapper.forEach(allValues, (count, value) => {\n    if (count == -1) lhs.push(value);\n    else if (count == 1) rhs.push(value);\n  });\n\n  return [lhs, rhs];\n}\n\nfunction _flattenStateStyles(styles: Array<string|{[key: string]: string|number}>): {[key: string]: string|number} {\n  var flatStyles: {[key: string]: string|number} = {};\n  styles.forEach(styleEntry => {\n    if (isStringMap(styleEntry)) {\n      StringMapWrapper.forEach(<{[key: string]: string|number}>styleEntry, (value, prop) => {\n        flatStyles[prop] = value;\n      });\n    }\n  });\n  return flatStyles;\n}\n\nfunction _fillStartAndEndStateSteps(entry: CompileAnimationMetadata | CompileAnimationMetadata[],\n                                    fromState: string,\n                                    toState: string,\n                                    stateStyles: {[key: string]: AnimationStylesAst},\n                                    errors: AnimationParseError[]): CompileAnimationSequenceMetadata {\n  var sequence: CompileAnimationSequenceMetadata;\n  var finalStep: CompileAnimationMetadata = null;\n  if (entry instanceof CompileAnimationSequenceMetadata) {\n    sequence = entry;\n    finalStep = sequence.steps[sequence.steps.length - 1];\n  } else {\n    var entries = isArray(entry)\n        ? <CompileAnimationMetadata[]>entry\n        : [<CompileAnimationMetadata>entry];\n    sequence = new CompileAnimationSequenceMetadata(entries);\n  }\n\n  var fromStateStyles = _fetchSylesFromState(fromState, stateStyles);\n  var toStateStyles = _fetchSylesFromState(toState, stateStyles);\n  var fromStyles = isPresent(fromStateStyles) ? _flattenStateStyles(fromStateStyles.styles) : {};\n  var toStyles = isPresent(toStateStyles) ? _flattenStateStyles(toStateStyles.styles) : {};\n\n  var fromStyleProps = StringMapWrapper.keys(fromStyles);\n  var toStyleProps = StringMapWrapper.keys(toStyles);\n  var missingStyles = _computeLhsSetDifference(fromStyleProps, toStyleProps);\n  var missingFromStyles = missingStyles[0];\n  var missingToStyles = missingStyles[1];\n  let firstStepStyles = fromStyleProps.length > 0 ? [fromStyles] : [];\n  if (missingFromStyles.length > 0) {\n    firstStepStyles.push(_populateMapFromKeyWithValue(missingFromStyles, AUTO_STYLE));\n  }\n  if (firstStepStyles.length > 0) {\n    let firstStep = new CompileAnimationStyleMetadata(0, firstStepStyles);\n    ListWrapper.insert(sequence.steps, 0, firstStep);\n  }\n\n  var lastStepStyles = toStyleProps.length > 0 ? [toStyles] : [];\n  if (missingToStyles.length > 0) {\n    lastStepStyles.push(_populateMapFromKeyWithValue(missingToStyles, AUTO_STYLE));\n  }\n\n  // look at the final step\n  // if it is an animate step where the final state value matches then apply\n  if (lastStepStyles.length > 0) {\n    if (isPresent(finalStep) && (finalStep instanceof CompileAnimationAnimateMetadata)) {\n      let animateStep = <CompileAnimationAnimateMetadata>finalStep;\n      let animateStyles = animateStep.styles;\n\n      // search through each of the style steps in the last animate step to\n      // see // if the final state is referenced. If so then replace the\n      // final state data with the states style values\n      var finalStateDetected = false;\n      animateStyles.forEach(styleMetadata => {\n        var finalStateIndex = -1;\n        var arr = styleMetadata.styles;\n        for (var j = 0; j < arr.length; j++) {\n          var styleEntry = arr[j];\n          if (styleEntry[0] == ':') {\n            var stateName = (<string>styleEntry).substring(1);\n            if (stateName == FINAL_STATE_ALIAS || stateName == toState) {\n              finalStateDetected = true;\n              finalStateIndex = j;\n              break;\n            }\n          }\n        }\n\n        if (finalStateIndex >= 0) {\n          lastStepStyles.forEach((entry, count) => {\n            if (count == 0) {\n              arr[finalStateIndex] = entry;\n            } else {\n              ListWrapper.insert(arr, finalStateIndex + count, entry);\n            }\n          });\n        }\n      });\n\n      if (!finalStateDetected) {\n        finalStep = null;\n      }\n    } else {\n      finalStep = null;\n    }\n\n    if (!isPresent(finalStep)) {\n      finalStep = new CompileAnimationStyleMetadata(0, lastStepStyles);\n      sequence.steps.push(finalStep);\n    }\n  }\n\n  return sequence;\n}\n\nfunction _populateMapFromKeyWithValue(keys: string[], value: any): {[key: string]: any} {\n  var data: {[key: string]: any} = {};\n  keys.forEach(key => {\n    data[key] = value;\n  });\n  return data;\n}\n\nfunction _normalizeStyleMetadata(entry: CompileAnimationStyleMetadata,\n                                 stateStyles: {[key: string]: AnimationStylesAst},\n                                 errors: AnimationParseError[]): Array<{[key: string]: string|number}> {\n  var normalizedStyles = [];\n  entry.styles.forEach(styleEntry => {\n    if (isString(styleEntry)) {\n      ListWrapper.addAll(normalizedStyles, _resolveStylesFromState(<string>styleEntry, stateStyles, errors));\n    } else {\n      normalizedStyles.push(<{[key: string]: string | number}>styleEntry);\n    }\n  });\n  return normalizedStyles;\n}\n\nfunction _normalizeStyleSteps(entry: CompileAnimationMetadata,\n                              stateStyles: {[key: string]: AnimationStylesAst},\n                              errors: AnimationParseError[]): CompileAnimationMetadata {\n  var steps = _normalizeStyleStepEntry(entry, stateStyles, errors);\n  if (steps.length == 1) {\n    return steps[0];\n  }\n  return new CompileAnimationSequenceMetadata(steps);\n}\n\nfunction _mergeAnimationStyles(stylesList: any[], newItem: {[key: string]: string|number}|string) {\n  if (isStringMap(newItem) && stylesList.length > 0) {\n    var lastIndex = stylesList.length - 1;\n    var lastItem = stylesList[lastIndex];\n    if (isStringMap(lastItem)) {\n      stylesList[lastIndex] = StringMapWrapper.merge(\n        <{[key: string]: string|number}>lastItem,\n        <{[key: string]: string|number}>newItem\n      );\n      return;\n    }\n  }\n  stylesList.push(newItem);\n}\n\nfunction _normalizeStyleStepEntry(entry: CompileAnimationMetadata,\n                                  stateStyles: {[key: string]: AnimationStylesAst},\n                                  errors: AnimationParseError[]): CompileAnimationMetadata[] {\n  var steps: CompileAnimationMetadata[];\n  if (entry instanceof CompileAnimationWithStepsMetadata) {\n    steps = entry.steps;\n  } else {\n    return [entry];\n  }\n\n  var newSteps: CompileAnimationMetadata[] = [];\n  var combinedStyles: {[key: string]: string | number}[];\n  steps.forEach(step => {\n    if (step instanceof CompileAnimationStyleMetadata) {\n      // this occurs when a style step is followed by a previous style step\n      // or when the first style step is run. We want to concatenate all subsequent\n      // style steps together into a single style step such that we have the correct\n      // starting keyframe data to pass into the animation player.\n      if (!isPresent(combinedStyles)) {\n        combinedStyles = [];\n      }\n      _normalizeStyleMetadata(<CompileAnimationStyleMetadata>step, stateStyles, errors).forEach(entry => {\n        _mergeAnimationStyles(combinedStyles, entry);\n      });\n    } else {\n      // it is important that we create a metadata entry of the combined styles\n      // before we go on an process the animate, sequence or group metadata steps.\n      // This will ensure that the AST will have the previous styles painted on\n      // screen before any further animations that use the styles take place.\n      if (isPresent(combinedStyles)) {\n        newSteps.push(new CompileAnimationStyleMetadata(0, combinedStyles));\n        combinedStyles = null;\n      }\n\n      if (step instanceof CompileAnimationAnimateMetadata) {\n        // we do not recurse into CompileAnimationAnimateMetadata since\n        // those style steps are not going to be squashed\n        (<CompileAnimationAnimateMetadata>step).styles.forEach(styleMetadata => {\n          styleMetadata.styles = _normalizeStyleMetadata(styleMetadata, stateStyles, errors);\n        });\n      } else if (step instanceof CompileAnimationWithStepsMetadata) {\n        let innerSteps = _normalizeStyleStepEntry(step, stateStyles, errors);\n        step = step instanceof CompileAnimationGroupMetadata\n            ? new CompileAnimationGroupMetadata(innerSteps)\n            : new CompileAnimationSequenceMetadata(innerSteps);\n      }\n\n      newSteps.push(step);\n    }\n  });\n\n  // this happens when only styles were animated within the sequence\n  if (isPresent(combinedStyles)) {\n    newSteps.push(new CompileAnimationStyleMetadata(0, combinedStyles));\n  }\n\n  return newSteps;\n}\n\n\nfunction _resolveStylesFromState(stateName: string, stateStyles: {[key: string]: AnimationStylesAst}, errors: AnimationParseError[]) {\n  var styles: {[key: string]: string|number}[] = [];\n  if (stateName[0] != ':') {\n    errors.push(new AnimationParseError(`Animation states via styles must be prefixed with a \":\"`));\n  } else {\n    var normalizedStateName = stateName.substring(1);\n    var value = stateStyles[normalizedStateName];\n    if (!isPresent(value)) {\n      errors.push(new AnimationParseError(`Unable to apply styles due to missing a state ${normalizedStateName}`));\n    } else {\n      value.styles.forEach(stylesEntry => {\n        if (isStringMap(stylesEntry)) {\n          styles.push(<{[key: string]: string | number}>stylesEntry);\n        }\n      });\n    }\n  }\n  return styles;\n}\n\nclass _AnimationTimings {\n  constructor(public duration: number, public delay: number, public easing: string) {}\n}\n\nfunction _parseAnimationDefinitionAnimation(entry: CompileAnimationMetadata,\n                                      currentTime: number,\n                                      collectedStyles: StylesCollection,\n                                      stateStyles: {[key: string]: AnimationStylesAst},\n                                      errors: AnimationParseError[]): AnimationAst {\n  var ast;\n  var playTime = 0;\n  var startingTime = currentTime;\n  if (entry instanceof CompileAnimationWithStepsMetadata) {\n    var maxDuration = 0;\n    var steps = [];\n    var isGroup = entry instanceof CompileAnimationGroupMetadata;\n    var previousStyles;\n    entry.steps.forEach(entry => {\n      // these will get picked up by the next step...\n      var time = isGroup ? startingTime : currentTime;\n      if (entry instanceof CompileAnimationStyleMetadata) {\n        entry.styles.forEach(stylesEntry => {\n          // by this point we know that we only have stringmap values\n          var map = <{[key: string]: string|number}>stylesEntry;\n          StringMapWrapper.forEach(map, (value, prop) => {\n            collectedStyles.insertAtTime(prop, time, value);\n          });\n        });\n        previousStyles = entry.styles;\n        return;\n      }\n\n      var innerAst = _parseAnimationDefinitionAnimation(entry, time, collectedStyles, stateStyles, errors);\n      if (isPresent(previousStyles)) {\n        if (entry instanceof CompileAnimationWithStepsMetadata) {\n          let startingStyles = new AnimationStylesAst(previousStyles);\n          steps.push(new AnimationStepAst(startingStyles, [], 0, 0, ''));\n        } else {\n          var innerStep = <AnimationStepAst>innerAst;\n          ListWrapper.addAll(innerStep.startingStyles.styles, previousStyles);\n        }\n        previousStyles = null;\n      }\n\n      var astDuration = innerAst.playTime;\n      currentTime += astDuration;\n      playTime += astDuration;\n      maxDuration = Math.max(astDuration, maxDuration);\n      steps.push(innerAst);\n    });\n    if (isPresent(previousStyles)) {\n      let startingStyles = new AnimationStylesAst(previousStyles);\n      steps.push(new AnimationStepAst(startingStyles, [], 0, 0, ''));\n    }\n    if (isGroup) {\n      ast = new AnimationGroupAst(steps);\n      playTime = maxDuration;\n      currentTime = startingTime + playTime;\n    } else {\n      ast = new AnimationSequenceAst(steps);\n    }\n  } else if (entry instanceof CompileAnimationAnimateMetadata) {\n    var timings = _parseTimeExpression(entry.timings, errors);\n\n    var totalEntries = entry.styles.length;\n    var totalOffsets = 0;\n    entry.styles.forEach(styleEntry => {\n      totalOffsets += isPresent(styleEntry.offset) ? 1 : 0;\n    });\n\n    if (totalOffsets > 0 && totalOffsets < entry.styles.length) {\n      errors.push(new AnimationParseError(`Not all style() entries contain an offset`));\n      totalOffsets = totalEntries;\n    }\n\n    var margin = totalOffsets == 0 ? (1 / totalEntries) : 0;\n    var keyframes: AnimationKeyframeAst[] = [];\n    var stylesList = [];\n    var index = 0;\n    entry.styles.forEach(styleMetadata => {\n      var offset = styleMetadata.offset;\n      var keyframeStyles = styleMetadata.styles.map(entry => {\n        return <{[key: string]: string|number}>entry;\n      });\n\n      if (!isPresent(offset)) {\n        offset = index == totalEntries - 1 ? _TERMINAL_KEYFRAME : (margin * index);\n      }\n\n      ListWrapper.addAll(stylesList, keyframeStyles);\n      var keyframe = new AnimationKeyframeAst(offset, new AnimationStylesAst(keyframeStyles));\n      keyframes.push(keyframe);\n      index++;\n    });\n\n    ast = new AnimationStepAst(new AnimationStylesAst([]), keyframes, timings.duration, timings.delay, timings.easing);\n    playTime = timings.duration + timings.delay;\n    currentTime += playTime;\n\n    stylesList.forEach(entry => {\n      StringMapWrapper.forEach(\n          entry, (value, prop) => { collectedStyles.insertAtTime(prop, currentTime, value); });\n    });\n  } else {\n    // if the code reaches this stage then an error\n    // has already been populated within the _normalizeStyleSteps()\n    // operation...\n    ast = new AnimationStepAst(null, [], 0, 0, '');\n  }\n\n  ast.playTime = playTime;\n  ast.startTime = startingTime;\n  return ast;\n}\n\nfunction _fillAnimationAstStartingKeyframes(ast: AnimationAst, collectedStyles: StylesCollection,\n                                            errors: AnimationParseError[]): void {\n  // steps that only contain style will not be filled\n  if ((ast instanceof AnimationStepAst) && ast.keyframes.length > 0) {\n    var keyframes = ast.keyframes;\n    if (keyframes.length == 1) {\n      var endKeyframe = keyframes[0];\n      var startKeyframe = _createStartKeyframeFromEndKeyframe(endKeyframe, ast.startTime,\n                                                              ast.playTime, collectedStyles, errors);\n      ast.keyframes = [startKeyframe, endKeyframe];\n    }\n  } else if (ast instanceof AnimationWithStepsAst) {\n    ast.steps.forEach(entry => _fillAnimationAstStartingKeyframes(entry, collectedStyles, errors));\n  }\n}\n\nfunction _parseTimeExpression(exp: string | number,\n                              errors: AnimationParseError[]): _AnimationTimings {\n  var regex = /^([\\.\\d]+)(m?s)(?:\\s+([\\.\\d]+)(m?s))?(?:\\s+([-a-z]+))?/gi;\n  var duration: number;\n  var delay: number = 0;\n  var easing: string = null;\n  if (isString(exp)) {\n    var matches = RegExpWrapper.firstMatch(regex, <string>exp);\n    if (!isPresent(matches)) {\n      errors.push(new AnimationParseError(`The provided timing value \"${exp}\" is invalid.`));\n      return new _AnimationTimings(0, 0, null);\n    }\n\n    var durationMatch = NumberWrapper.parseFloat(matches[1]);\n    var durationUnit = matches[2];\n    if (durationUnit == 's') {\n      durationMatch *= _ONE_SECOND;\n    }\n    duration = Math.floor(durationMatch);\n\n    var delayMatch = matches[3];\n    var delayUnit = matches[4];\n    if (isPresent(delayMatch)) {\n      var delayVal: number = NumberWrapper.parseFloat(delayMatch);\n      if (isPresent(delayUnit) && delayUnit == 's') {\n        delayVal *= _ONE_SECOND;\n      }\n      delay = Math.floor(delayVal);\n    }\n\n    var easingVal = matches[5];\n    if (!isBlank(easingVal)) {\n      easing = easingVal;\n    }\n  } else {\n    duration = <number>exp;\n  }\n\n  return new _AnimationTimings(duration, delay, easing);\n}\n\nfunction _createStartKeyframeFromEndKeyframe(endKeyframe: AnimationKeyframeAst, startTime: number,\n                                             duration: number, collectedStyles: StylesCollection,\n                                             errors: AnimationParseError[]): AnimationKeyframeAst {\n  var values: {[key: string]: string | number} = {};\n  var endTime = startTime + duration;\n  endKeyframe.styles.styles.forEach((styleData: {[key: string]: string|number}) => {\n    StringMapWrapper.forEach(styleData, (val, prop) => {\n      if (prop == 'offset') return;\n\n      var resultIndex = collectedStyles.indexOfAtOrBeforeTime(prop, startTime);\n      var resultEntry, nextEntry, value;\n      if (!isPresent(resultIndex)) {\n        errors.push(new AnimationParseError(\n            `The CSS style:value entry \"${prop}:${val}\" cannot be animated because \"${prop}\" has not been styled within a previous style step`));\n        value = null;\n      } else {\n        resultEntry = collectedStyles.getByIndex(prop, resultIndex);\n        value = resultEntry.value;\n        nextEntry = collectedStyles.getByIndex(prop, resultIndex + 1);\n      }\n\n      if (isPresent(nextEntry) && !nextEntry.matches(endTime, val)) {\n        errors.push(new AnimationParseError(\n            `The animated CSS property \"${prop}\" unexpectedly changes between steps \"${resultEntry.time}ms\" and \"${endTime}ms\" at \"${nextEntry.time}ms\"`));\n      }\n\n      values[prop] = value;\n    });\n  });\n\n  return new AnimationKeyframeAst(_INITIAL_KEYFRAME, new AnimationStylesAst([values]));\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}